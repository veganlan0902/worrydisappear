<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>煩惱消散器 | Worry Dissolver</title>
    <style>
        /* CSS 樣式部分... (保持不變) */
        :root {
            --primary-color: #FF7043; /* 暖橘色 (核心動作色) */
            --primary-light: #FFAB91; /* 較淺的橘色 */
            --primary-dark: #F4511E;  /* 較深的橘色 */
            --accent-color: #FFCA28;  /* 金黃色 (強調色，可選用) */
            --bg-color-light: #FFF3E0; /* 淺米色背景 */
            --bg-color-dark: #FFEDE0; /* 較深的米色背景 */
            --text-color-dark: #3E2723; /* 深棕色文字 (主要) */
            --text-color-medium: #5D4037; /* 中棕色文字 (次要) */
            --text-color-light: #795548; /* 淺棕色文字 (提示) */
            --shadow-subtle: 0 4px 12px rgba(0, 0, 0, 0.1);
            --shadow-strong: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        body {
            font-family: 'Noto Sans TC', 'Roboto', '微軟正黑體', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, var(--bg-color-light) 0%, var(--bg-color-dark) 100%); 
            color: var(--text-color-dark);
            text-align: center;
            transition: background 0.5s ease-in-out;
            overflow: hidden; 
        }

        .container {
            background: rgba(255, 255, 255, 0.95); 
            padding: 45px;
            border-radius: 20px;
            box-shadow: var(--shadow-strong);
            max-width: 550px;
            width: 90%;
            transition: box-shadow 0.4s ease-in-out; 
            position: relative;
            z-index: 10; 
            border: 1px solid rgba(255, 255, 255, 0.6); 
        }

        .container:hover {
            transform: none; 
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.2);
        }

        h1 {
            color: var(--primary-dark);
            margin-bottom: 35px;
            font-size: 2.5em;
            font-weight: 800;
            letter-spacing: 1px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.05);
        }

        p {
            color: var(--text-color-medium);
            font-size: 1.1em;
            margin-bottom: 25px;
        }

        textarea {
            width: calc(100% - 30px);
            min-height: 160px;
            padding: 15px;
            margin-bottom: 30px;
            border: 2px solid var(--primary-light); 
            border-radius: 12px;
            font-size: 1.15em;
            color: var(--text-color-dark);
            background-color: rgba(255, 255, 255, 0.8);
            resize: vertical;
            transition: border-color 0.4s ease-in-out, box-shadow 0.4s ease-in-out;
            box-sizing: border-box; 
        }

        textarea:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(255, 112, 67, 0.3); 
            outline: none;
        }

        button {
            background-color: var(--primary-color);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: 700;
            letter-spacing: 0.5px;
            box-shadow: var(--shadow-subtle);
            transition: background-color 0.3s ease-in-out, transform 0.2s ease-in-out, box-shadow 0.3s ease-in-out;
        }

        button:hover {
            background-color: var(--primary-dark);
            box-shadow: var(--shadow-strong);
        }

        button:active {
            transform: scale(0.95) rotateZ(-2deg); 
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
        }

        /* 結果顯示區塊樣式 (保持不變) */
        #result {
            margin-top: 40px;
            padding: 25px;
            border: 2px solid var(--primary-light);
            border-radius: 15px;
            background-color: rgba(255, 243, 224, 0.8); 
            min-height: 120px;
            opacity: 0;
            transform: translateY(20px); 
            transition: opacity 1s ease-out, transform 1s cubic-bezier(0.2, 0.8, 0.2, 1);
            text-align: left; 
        }

        #result.show {
            opacity: 1;
            transform: translateY(0); 
        }

        #proverb-intro {
            font-size: 1.1em;
            color: var(--text-color-medium);
            margin-bottom: 15px;
            text-align: center; 
        }

        #proverb-text {
            font-size: 1.4em;
            font-weight: bold;
            color: var(--primary-dark);
            margin-bottom: 10px;
            line-height: 1.5;
            text-align: center; 
        }

        #proverb-source {
            font-style: italic;
            color: var(--text-color-light);
            display: block;
            margin-bottom: 20px;
            font-size: 0.95em;
            text-align: right; 
        }

        #proverb-explanation {
            font-size: 1.05em;
            line-height: 1.7;
            color: var(--text-color-dark);
            background-color: rgba(255, 255, 255, 0.7);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid var(--primary-color); 
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.08);
        }

        /* 華麗的煩惱消散動畫效果 (保持不變) */
        #dissolve-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, rgba(255, 255, 255, 0.98) 0%, rgba(255, 240, 220, 0.95) 70%, rgba(255, 220, 200, 0.9) 100%);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999; 
            opacity: 1;
            transition: opacity 0.5s ease-out; 
            perspective: 1000px; 
        }

        .dissolve-message-text {
            opacity: 1;
            transform: scale(1) translateY(0) rotateX(0deg);
            filter: blur(0px);
            letter-spacing: 0px;
            color: var(--primary-dark);
            font-size: 4em; 
            font-weight: 900;
            text-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: all 2s cubic-bezier(0.42, 0, 1.0, 1.0); 
            white-space: pre-wrap; 
            max-width: 90vw; 
            overflow: hidden; 
        }

        #dissolve-overlay.dissolve-start .dissolve-message-text {
            opacity: 0;
            transform: scale(5) translateY(-200px) rotateX(45deg); 
            filter: blur(100px); 
            letter-spacing: 2em; 
        }

        /* Footer for language info */
        .footer {
            margin-top: 30px;
            font-size: 0.85em;
            color: var(--text-color-light);
        }
    </style>
</head>
<body>

    <div id="dissolve-overlay">
        <span id="dissolve-message-text" class="dissolve-message-text"></span>
    </div>

    <div class="container">
        <h1 id="title"></h1>
        <p id="instruction-text"></p>
        <textarea id="worry-input"></textarea>
        <button id="dissolve-button"></button>

        <div id="result">
            <p id="proverb-intro"></p>
            <p id="proverb-text"></p>
            <span id="proverb-source"></span>
            <p id="proverb-explanation"></p>
        </div>

        <div class="footer" id="language-info"></div>
    </div>

    <script>
        // 1. **優化後的 i18n 資料結構**：將固定界面文案和法語資料庫分離
        
        // A. 界面文案翻譯 (Translations)
        const translations = {
            'zh-TW': {
                langName: "繁體中文",
                title: "煩惱消散器",
                instructionText: "請在下方寫下您當前的煩惱、疑惑或想放下的事情：",
                inputPlaceholder: "例如：我擔心專案會來不及完成，這讓我夜不能寐。",
                buttonText: "✨ 讓煩惱煙消雲散！ ✨",
                dissolveMessage: "您的煩惱正在化為塵埃...",
                proverbIntro: "⭐ 既然放下，便聽聽祖師的智慧之語：",
            },
            'en': {
                langName: "English",
                title: "Worry Dissolver",
                instructionText: "Write down your current worry, doubt, or something you wish to let go of below:",
                inputPlaceholder: "E.g., I'm worried about not finishing the project on time, it keeps me awake at night.",
                buttonText: "✨ Let My Worries Dissolve! ✨",
                dissolveMessage: "Your worries are turning into dust...",
                proverbIntro: "⭐ Now that you've let go, listen to the wisdom of the masters:",
            }
        };

        // B. 法語資料庫 (Proverbs Data) - 不再重複固定的界面文案
        const proverbsData = [
            { 
                zh: "境是道場，辱罵是真經。", 
                source: "廣欽老和尚", 
                explanation_zh: "逆境與惡言都是修行的機會，應視為磨練心性的珍寶。",
                explanation_en: "Adversity and harsh words are opportunities for practice, and should be regarded as treasures that temper the mind."
            },
            { 
                zh: "修行就是在修我們這忍耐性。", 
                source: "廣欽老和尚", 
                explanation_zh: "所有順逆境都是在磨練忍辱波羅蜜的道場，能忍才能進步。",
                explanation_en: "All favorable and adverse situations are a practice ground for cultivating *kshanti-paramita* (patience); only by enduring can we progress."
            },
            // 如果您有 100 句法語，只需在這個列表中增加 98 個物件即可，無需重複界面文案。
        ];

        let currentLang = 'zh-TW'; 
        
        // 2. 語言偵測與切換
        function detectAndSetLanguage() {
            const browserLang = navigator.language || navigator.userLanguage;
            const langLower = browserLang.toLowerCase();

            // 1. 如果是繁體中文 (zh-TW 或 zh-Hant)，設定為 'zh-TW'
            if (langLower.startsWith('zh') && (langLower.includes('tw') || langLower.includes('hant'))) {
                currentLang = 'zh-TW';

            // 2. 如果是英文，設定為 'en'
            } else if (langLower.startsWith('en')) {
                currentLang = 'en';
            
            // 3. 其他所有情況 (非 zh-TW 也非 en) 預設為 'en'
            } else {
                currentLang = 'en'; // 其他語言預設為英文
            }

            const langData = translations[currentLang] || translations['en']; 
            
            // Apply text content
            document.getElementById('title').textContent = langData.title;
            document.getElementById('instruction-text').textContent = langData.instructionText;
            document.getElementById('worry-input').placeholder = langData.inputPlaceholder;
            document.getElementById('dissolve-button').textContent = langData.buttonText;
            document.getElementById('proverb-intro').textContent = langData.proverbIntro;
            document.getElementById('dissolve-message-text').textContent = langData.dissolveMessage;

            // Set the HTML lang attribute for better accessibility/SEO
            document.documentElement.lang = currentLang === 'en' ? 'en' : 'zh-Hant';
        }


        // 3. 煩惱消散器邏輯
        function dissolveWorry() {
            const inputElement = document.getElementById('worry-input');
            const resultElement = document.getElementById('result');
            const overlay = document.getElementById('dissolve-overlay');
            const dissolveMessageText = document.getElementById('dissolve-message-text');
            const langData = translations[currentLang] || translations['en']; // 使用新的 translations 變數
            
            const worryText = inputElement.value.trim();

            if (worryText === '') {
                alert(currentLang === 'en' ? 'Please write down your worry first.' : '請先寫下您的煩惱。');
                return;
            }

            // --- 步驟 1: 準備動畫 ---
            dissolveMessageText.textContent = worryText; 
            overlay.style.display = 'flex';
            resultElement.classList.remove('show');
            
            setTimeout(() => {
                overlay.classList.add('dissolve-start');
            }, 50); 

            // --- 步驟 2: 處理煩惱並顯示法語 (延遲 4 秒) ---
            const animationDuration = 2000; 
            setTimeout(() => {
                // 清空輸入框 (煩惱已消散)
                inputElement.value = '';

                // 隨機選擇一則法語
                const randomIndex = Math.floor(Math.random() * proverbsData.length);
                const proverb = proverbsData[randomIndex];
                
                // 根據當前語言選擇正確的解釋鍵
                const explanationKey = currentLang === 'zh-TW' ? 'explanation_zh' : 'explanation_en';
                
                // 顯示法語 (中文原文)
                document.getElementById('proverb-text').textContent = proverb.zh; 
                document.getElementById('proverb-source').textContent = '— ' + proverb.source;
                
                // 顯示解釋 (根據語系切換)
                document.getElementById('proverb-explanation').textContent = proverb[explanationKey];

                // --- 步驟 3: 結束動畫並顯示結果 ---
                overlay.classList.remove('dissolve-start');
                overlay.style.display = 'none';
                
                // 顯示結果區塊
                resultElement.classList.add('show');

            }, animationDuration + 100); 
        }

        // 4. 事件監聽器
        document.getElementById('dissolve-button').addEventListener('click', dissolveWorry);

        // 5. 初始化：偵測語系並套用文案
        window.onload = detectAndSetLanguage;
    </script>
</body>
</html>
